{"ast":null,"code":"import _regeneratorRuntime from\"/Users/dcash/Desktop/react_portfolio/react-rmdb-starterFiles_rev1/React_MDB_App_Portfolio_Example/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Users/dcash/Desktop/react_portfolio/react-rmdb-starterFiles_rev1/React_MDB_App_Portfolio_Example/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/Users/dcash/Desktop/react_portfolio/react-rmdb-starterFiles_rev1/React_MDB_App_Portfolio_Example/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/dcash/Desktop/react_portfolio/react-rmdb-starterFiles_rev1/React_MDB_App_Portfolio_Example/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useEffect,useCallback}from'react';import{API_URL,API_KEY}from'../../config';export var useMovieFetch=function useMovieFetch(movieId){var _useState=useState({}),_useState2=_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),error=_useState6[0],setError=_useState6[1];var fetchData=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var endpoint,result,creditsEndpoint,creditsResult,directors;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setError(false);setLoading(true);_context.prev=2;endpoint=\"\".concat(API_URL,\"movie/\").concat(movieId,\"?api_key=\").concat(API_KEY);_context.next=6;return fetch(endpoint);case 6:_context.next=8;return _context.sent.json();case 8:result=_context.sent;creditsEndpoint=\"\".concat(API_URL,\"movie/\").concat(movieId,\"/credits?api_key=\").concat(API_KEY);_context.next=12;return fetch(creditsEndpoint);case 12:_context.next=14;return _context.sent.json();case 14:creditsResult=_context.sent;directors=creditsResult.crew.filter(function(member){return member.job==='Director';});setState(_objectSpread(_objectSpread({},result),{},{actors:creditsResult.cast,directors:directors}));_context.next=22;break;case 19:_context.prev=19;_context.t0=_context[\"catch\"](2);setError(true);case 22:setLoading(false);case 23:case\"end\":return _context.stop();}}},_callee,null,[[2,19]]);})),[movieId]);useEffect(function(){if(localStorage[movieId]){setState(JSON.parse(localStorage[movieId]));setLoading(false);}else{fetchData();}},[fetchData,movieId]);useEffect(function(){localStorage.setItem(movieId,JSON.stringify(state));},[movieId,state]);return[state,loading,error];};","map":{"version":3,"sources":["/Users/dcash/Desktop/react_portfolio/react-rmdb-starterFiles_rev1/React_MDB_App_Portfolio_Example/src/components/hooks/useMovieFetch.js"],"names":["useState","useEffect","useCallback","API_URL","API_KEY","useMovieFetch","movieId","state","setState","loading","setLoading","error","setError","fetchData","endpoint","fetch","json","result","creditsEndpoint","creditsResult","directors","crew","filter","member","job","actors","cast","localStorage","JSON","parse","setItem","stringify"],"mappings":"41BAAA,OAASA,QAAT,CAAmBC,SAAnB,CAA8BC,WAA9B,KAAiD,OAAjD,CACA,OAASC,OAAT,CAAkBC,OAAlB,KAAiC,cAAjC,CAEA,MAAO,IAAMC,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,CAAAC,OAAO,CAAI,eACbN,QAAQ,CAAC,EAAD,CADK,wCAC/BO,KAD+B,eACzBC,QADyB,8BAERR,QAAQ,CAAC,IAAD,CAFA,yCAE/BS,OAF+B,eAEtBC,UAFsB,8BAGZV,QAAQ,CAAC,KAAD,CAHI,yCAG/BW,KAH+B,eAGxBC,QAHwB,eAKtC,GAAMC,CAAAA,SAAS,CAAGX,WAAW,sEAAC,+LAC5BU,QAAQ,CAAE,KAAF,CAAR,CACAF,UAAU,CAAE,IAAF,CAAV,CAF4B,gBAKpBI,QALoB,WAKNX,OALM,kBAKUG,OALV,qBAK6BF,OAL7B,wBAMEW,CAAAA,KAAK,CAACD,QAAD,CANP,6CAMmBE,IANnB,UAMpBC,MANoB,eAOpBC,eAPoB,WAOCf,OAPD,kBAOiBG,OAPjB,6BAO4CF,OAP5C,yBAQSW,CAAAA,KAAK,CAACG,eAAD,CARd,+CAQiCF,IARjC,WAQpBG,aARoB,eASpBC,SAToB,CASRD,aAAa,CAACE,IAAd,CAAmBC,MAAnB,CAChB,SAAAC,MAAM,QAAIA,CAAAA,MAAM,CAACC,GAAP,GAAe,UAAnB,EADU,CATQ,CAa1BhB,QAAQ,gCACHS,MADG,MAENQ,MAAM,CAAEN,aAAa,CAACO,IAFhB,CAGNN,SAAS,CAATA,SAHM,GAAR,CAb0B,iFAoB1BR,QAAQ,CAAC,IAAD,CAAR,CApB0B,QAsB5BF,UAAU,CAAC,KAAD,CAAV,CAtB4B,qEAAD,GAuB1B,CAACJ,OAAD,CAvB0B,CAA7B,CAyBAL,SAAS,CAAC,UAAI,CACZ,GAAI0B,YAAY,CAACrB,OAAD,CAAhB,CAA2B,CACzBE,QAAQ,CAACoB,IAAI,CAACC,KAAL,CAAWF,YAAY,CAACrB,OAAD,CAAvB,CAAD,CAAR,CACII,UAAU,CAAC,KAAD,CAAV,CAEL,CAJD,IAIO,CACLG,SAAS,GACV,CACF,CARQ,CAQN,CAACA,SAAD,CAAYP,OAAZ,CARM,CAAT,CAWAL,SAAS,CAAC,UAAK,CACb0B,YAAY,CAACG,OAAb,CAAqBxB,OAArB,CAA8BsB,IAAI,CAACG,SAAL,CAAexB,KAAf,CAA9B,EACD,CAFQ,CAEN,CAACD,OAAD,CAAUC,KAAV,CAFM,CAAT,CAIA,MAAO,CAACA,KAAD,CAAOE,OAAP,CAAgBE,KAAhB,CAAP,CACD,CA9CM","sourcesContent":["import { useState, useEffect, useCallback } from 'react';\nimport { API_URL, API_KEY } from '../../config';\n\nexport const useMovieFetch = movieId => {\n  const [state,setState] = useState({});\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(false);\n\n  const fetchData = useCallback(async () => {\n    setError (false);\n    setLoading (true);\n\n    try {\n      const endpoint = `${API_URL}movie/${movieId}?api_key=${API_KEY}`;\n      const result = await (await fetch(endpoint)).json();\n      const creditsEndpoint = `${API_URL}movie/${movieId}/credits?api_key=${API_KEY}`;\n      const creditsResult = await (await fetch(creditsEndpoint)).json();\n      const directors = creditsResult.crew.filter(\n        member => member.job === 'Director'\n      );\n\n      setState({\n        ...result,\n        actors: creditsResult.cast,\n        directors,\n      })\n\n    } catch (error) {\n      setError(true);\n    }\n    setLoading(false);\n  }, [movieId])\n\n  useEffect(()=>{\n    if (localStorage[movieId]) {\n      setState(JSON.parse(localStorage[movieId]));\n          setLoading(false);\n\n    } else {\n      fetchData();\n    }\n  }, [fetchData, movieId]);\n\n\n  useEffect(() =>{\n    localStorage.setItem(movieId, JSON.stringify(state));\n  }, [movieId, state]);\n\n  return [state,loading, error];\n}\n"]},"metadata":{},"sourceType":"module"}